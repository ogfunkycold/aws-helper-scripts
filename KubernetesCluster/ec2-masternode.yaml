AWSTemplateFormatVersion: "2010-09-09"
Metadata:
    Author: "VirtIOGroove 2020"
Description: "Kubernetes cluster with Calico"
Parameters:
      KeyName:
        Type: AWS::EC2::KeyPair::KeyName
        ConstraintDescription: Must be existing key
      SubnetName: 
        Type: AWS::EC2::Subnet::Id
      SecurityGroup:
        Type: AWS::EC2::SecurityGroup::Id

Resources:
    EC2Instance:
        Type: "AWS::EC2::Instance"
        Properties:
            ImageId: "ami-0dba2cb6798deb6d8"
            InstanceType: "t2.medium"
            KeyName: !Ref KeyName
            SubnetId: !Ref SubnetName
            SecurityGroupIds:
                - !Ref SecurityGroup
            Tenancy: "default"
            EbsOptimized: false
            UserData: "IyEvYmluL2Jhc2gKYXB0IHVwZGF0ZQphcHQgaW5zdGFsbCBhcHQtdHJhbnNwb3J0LWh0dHBzIGNhLWNlcnRpZmljYXRlcyBjdXJsIHNvZnR3YXJlLXByb3BlcnRpZXMtY29tbW9uIC15CmN1cmwgLWZzU0wgaHR0cHM6Ly9kb3dubG9hZC5kb2NrZXIuY29tL2xpbnV4L3VidW50dS9ncGcgfCBzdWRvIGFwdC1rZXkgYWRkIC0KYWRkLWFwdC1yZXBvc2l0b3J5ICJkZWIgW2FyY2g9YW1kNjRdIGh0dHBzOi8vZG93bmxvYWQuZG9ja2VyLmNvbS9saW51eC91YnVudHUgZm9jYWwgc3RhYmxlIgoKYXB0IHVwZGF0ZQphcHQtY2FjaGUgcG9saWN5IGRvY2tlci1jZQphcHQgaW5zdGFsbCBkb2NrZXItY2UgLXkKCiNOZXh0IDIgbGluZXMgYXJlIGRpZmZlcmVudCBmcm9tIG9mZmljaWFsIEt1YmVybmV0ZXMgZ3VpZGUsIGJ1dCB0aGUgd2F5IEt1YmVybmV0ZXMgZGVzY3JpYmUgc3RlcCBkb2VzIG5vdCB3b3JrCmN1cmwgLXMgaHR0cHM6Ly9wYWNrYWdlcy5jbG91ZC5nb29nbGUuY29tL2FwdC9kb2MvYXB0LWtleS5ncGcgfCAgYXB0LWtleSBhZGQKZWNobyAiZGViIGh0dHBzOi8vcGFja2FnZXMuY2xvdWQuZ29vZ2xlLmNvbS9hcHQga3ViZXJuZXRlcy14ZW5pYWwgbWFpbiIgPiAvZXRjL2FwdC9zb3VyY2VzLmxpc3QuZC9rdXJiZW5ldGVzLmxpc3QKCiNUdXJuIG9mZiBzd2FwCnN3YXBvZmYgLWEKCmFwdCB1cGRhdGUKYXB0IGluc3RhbGwga3ViZWxldCBrdWJlYWRtIGt1YmVjdGwgLXkKI3dlIG5lZWQgdG8gZ2V0IEVDMiBpbnRlcm5hbCBJUCBhZGRyZXNzLSBkZWZhdWx0IEVOSSBpcyBldGgwCmV4cG9ydCBpcGFkZHI9YGlwIGFkZHJlc3N8Z3JlcCBldGgwfGdyZXAgaW5ldHxhd2sgLUYgJyAnICd7cHJpbnQgJDJ9JyB8YXdrIC1GICdcLycgJ3twcmludCAkMX0nYAoKI1lvdSBjYW4gcmVwbGFjZSAxNzIuMTYuMC4wLzE2IHdpdGggeW91ciBkZXNpcmVkIHBvZCBuZXR3b3JrCmt1YmVhZG0gaW5pdCAtLWFwaXNlcnZlci1hZHZlcnRpc2UtYWRkcmVzcz0kaXBhZGRyIC0tcG9kLW5ldHdvcmstY2lkcj0xNzIuMTYuMC4wLzE2CgojdGhpcyBhZGRzIC5rdWJlL2NvbmZpZyBmb3Igcm9vdCBhY2NvdW50LCBydW4gc2FtZSBmb3IgdWJ1bnR1IHVzZXIsIGlmIHlvdSBuZWVkIGl0Cm1rZGlyIC1wIC9yb290Ly5rdWJlCmNwIC1pIC9ldGMva3ViZXJuZXRlcy9hZG1pbi5jb25mIC9yb290Ly5rdWJlL2NvbmZpZwoKCiNZb3UgbmVlZCB0byB1bmNvbW1lbnQgb25lIG9mIDIgbmV4dCBsaW5lcyAtIGZsYW5uZWwgYW5kIGNhbGljbyB1c2VkIGhlcmUgYXMgYW4gZXhhbXBsZS4KCiNVbmNvbW1lbnQgbmV4dCBsaW5lIGlmIHlvdSB3YW50IGZsYW5uZWwgQ2x1c3RlciBQb2QgTmV0d29yawojY3VybCAtbyAvcm9vdC9rdWJlLWZsYW5uZWwueW1sIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9jb3Jlb3MvZmxhbm5lbC9tYXN0ZXIvRG9jdW1lbnRhdGlvbi9rdWJlLWZsYW5uZWwueW1sCiNrdWJlY3RsIC0ta3ViZWNvbmZpZyAvcm9vdC8ua3ViZS9jb25maWcgYXBwbHkgLWYgL3Jvb3Qva3ViZS1mbGFubmVsLnltbAoKI1VuY29tbWVudCBuZXh0IGxpbmUgaWYgeW91IHdhbnQgY2FsaWNvIENsdXN0ZXIgUG9kIE5ldHdvcmsKY3VybCAtbyAvcm9vdC9jYWxpY28ueWFtbCBodHRwczovL2RvY3MucHJvamVjdGNhbGljby5vcmcvdjMuMTYvbWFuaWZlc3RzL2NhbGljby55YW1sCmt1YmVjdGwgLS1rdWJlY29uZmlnIC9yb290Ly5rdWJlL2NvbmZpZyBhcHBseSAtZiAvcm9vdC9jYWxpY28ueWFtbAoKI1VuY29tbWVudCBuZXh0IGxpbmUgaWYgeW91IGFyZSBwbGFubmluZyBtb3JlIG5vZGVzLCB0aGlzIHdpbGwgcHV0IGNsdXN0ZXIgam9pbiBjb21tYW5kIHRvIC9yb290L2NsdXN0ZXJqb2luLnNoIGZpbGUKI2t1YmVhZG0gdG9rZW4gY3JlYXRlIC0tcHJpbnQtam9pbi1jb21tYW5kID5jbHVzdGVyam9pbi5zaAoKI1VuY29tbWVudCB0aGUgbmV4dCBsaW5lIGlmIHlvdSBuZWVkIHRvIHJ1biBwb2RzIG9uIG1hc3RlciBub2RlCiNrdWJlY3RsIHRhaW50IG5vZGUgLS1hbGwgbm9kZS1yb2xlLmt1YmVybmV0ZXMuaW8vbWFzdGVyOk5vU2NoZWR1bGUtCgojVW5jb21tZW50IGJlbGxvdyBsaW5lcyBpZiB5b3UgbmVlZCB0byBpbnN0YWxsIGhlbHAKI2N1cmwgaHR0cHM6Ly9iYWx0b2Nkbi5jb20vaGVsbS9zaWduaW5nLmFzYyB8IHN1ZG8gYXB0LWtleSBhZGQgLQojYXB0IGluc3RhbGwgYXB0LXRyYW5zcG9ydC1odHRwcyAteQojZWNobyAiZGViIGh0dHBzOi8vYmFsdG9jZG4uY29tL2hlbG0vc3RhYmxlL2RlYmlhbi8gYWxsIG1haW4iIHwgdGVlIC9ldGMvYXB0L3NvdXJjZXMubGlzdC5kL2hlbG0tc3RhYmxlLWRlYmlhbi5saXN0CiNhcHQgdXBkYXRlCiNhcHQgaW5zdGFsbCBoZWxtIC15Cg=="
            
